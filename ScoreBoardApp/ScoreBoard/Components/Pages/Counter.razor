@page "/counter"
@rendermode InteractiveServer

<PageTitle>Counter</PageTitle>

<h1>Counter</h1>

<p role="status">Current count: @currentCount</p>

@* <button class="btn btn-primary" @onclick="IncrementCount">Click me</button> *@

<div class="container text-center" id="scoreboard">
    <div class="input-group mb-3">
        <input type="text" class="form-control" @bind="compName" placeholder="Enter league or competition name" name="comp-name" autocomplete="on" />
        <button class="btn btn-outline-primary" type="button" @onclick="ConfirmCompName">Confirm</button>
    </div>
    <p><strong>@confirmedCompName</strong></p>
    <hr />

    <!-- Row for Team 1 and Team 2 -->
    <div class="row justify-content-center">

        <!-- Team 1 -->
        <div class="col-md-4">
            <div class="input-group mb-3">
                <input type="text" class="form-control" @bind="teamName1" placeholder="Enter team name" name="team1-name" autocomplete="on" />
                <button class="btn btn-primary" type="button" @onclick="ConfirmTeamName1">Confirm</button>
            </div>
            <p><h2>@confirmedTeamName1</h2></p>
        </div>

            <!-- Team 1 Score Input -->
            <div class="col-md-1">
                    <input type="number" class="form-control" @bind="team1score" />
            </div>

            @* Dash *@
            <div class="col-md-1 text-center">
                <h2><strong>-</strong></h2>
            </div>

            <!-- Team 2 Score Input -->
            <div class="col-md-1">
                    <input type="number" class="form-control" @bind="team2score" />
            </div>

        <!-- Team 2 -->
        <div class="col-md-4">
            <div class="input-group mb-3">
                <input type="text" class="form-control" @bind="teamName2" placeholder="Enter team name" name="team2-name" autocomplete="on" />
                <button class="btn btn-primary" type="button" @onclick="ConfirmTeamName2">Confirm</button>
            </div>
            <p><h2>@confirmedTeamName2</h2></p>
        </div>
    </div>
                                                              
    <p><strong>@team1score - @team2score</strong></p>
    <!-- Timer -->
    <div class="mt-4">
        <h2>@timeElapsedString</h2>
    </div>

</div>

@code {
    private int currentCount = 0; 

    private string compName = "";
    private string confirmedCompName = "";
    private string teamName1 = "";
    private string confirmedTeamName1 = "";
    private string teamName2 = "";
    private string confirmedTeamName2 = "";
    private int team1score = 0;
    private int team2score = 0;

    private TimeSpan timeElapsed = TimeSpan.Zero;
    private string timeElapsedString = "00:00";
    private System.Timers.Timer? timer;

    protected override void OnInitialized()
    {
        timer = new System.Timers.Timer(1000); // Timer will tick every second (1000 milliseconds)
        timer.Elapsed += OnTimerElapsed;
        timer.Start();
    }

    private void OnTimerElapsed(object? sender, System.Timers.ElapsedEventArgs e)
    {
        timeElapsed = timeElapsed.Add(TimeSpan.FromSeconds(1));

        if (timeElapsed.TotalMinutes < 90)
        {
            timeElapsedString = timeElapsed.ToString(@"mm\:ss");
        }
        else
        {
            timeElapsedString = "90:00";
            timer?.Stop();
        }

        InvokeAsync(StateHasChanged); // To update the UI on each tick
    }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

    private void IncrementCount()
    {
        currentCount++;
    }
    private void ConfirmCompName() => confirmedCompName = compName;

    private void ConfirmTeamName1() => confirmedTeamName1 = teamName1;

    private void ConfirmTeamName2() => confirmedTeamName2 = teamName2;
}
